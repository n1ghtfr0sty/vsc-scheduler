# OpenCode Development Log - 2026-02-21/22

**Date**: 2026-02-21 to 2026-02-22
**Session**: ~6 hours total

---

## GitHub Commits (in order)

1. `c01f84b` - Initial commit: VSC Scheduler project
2. `332b7d7` - Add gold candle light effect on mouse position
3. `537c375` - Reduce candle light brightness to 25%
4. `b70fbba` - Add custom calendar component to dashboard
5. `3dab72b` - Fix calendar onclick handlers
6. `699eefa` - Fix API auth error handling
7. `3169656` - Fix calendar week view navigation
8. `629381e` - Add full rosters to teams: U6-U8 (8), U9-U10 (12), U11-U12 (14), U13-U16 (18)
9. `dfdbe77` - Fix: Make email login case-insensitive

---

## Changes Made (Detailed)

### 1. sql.js Migration (c01f84b)
**Reason:** better-sqlite3 requires native compilation which failed due to missing Windows SDK.

**Files:**
- `package.json` - Replaced `better-sqlite3` with `sql.js`
- `src/db.js` - Rewrote to use sql.js with async initialization and proxy wrapper
- `src/seed.js` - Updated to use async `getDb()` 
- `src/schema.js` - Updated to use async `getDb()`
- `src/index.js` - Added db initialization and dynamic route loading

### 2. Stop Script (c01f84b)
- `package.json` - Added `"stop": "taskkill /F /IM node.exe /T 2>nul || echo No server running"`

---

### 3. Dark Theme Styling
**Files:** `public/css/style.css`

**Color Scheme:**
- Primary: Forest Green (#228B22)
- Gold: #FFD700
- Background: Dark (#121212, #1a1a1a)
- Cards: #242424
- Text: #e0e0e0

**Features:**
- Gradient buttons and headers
- Gold accents for headings
- Smooth transitions and hover effects
- Improved card styling
- Responsive design

---

### 4. Navigation Button Styling
**Files:** `public/css/style.css`

**Changes:**
- Nav links styled as buttons with gradients
- 3D hover effect: translateY(-2px) + enhanced shadow
- Gold gradient on hover
- Logout button styled with red hover

---

### 5. Animated Soccer Ball Background (332b7d7, 537c375)
**Added:** `public/js/background.js`
**Modified:** `public/index.html`, `public/css/style.css`

**Features:**
- Canvas-based animated background
- Floating soccer balls with gold pentagon patterns
- Slow, gentle movement with rotation
- Low opacity (~8-25%)
- Semi-transparent app container with blur

---

### 6. Gold Candle Light Mouse Effect (332b7d7, 537c375)
**Modified:** `public/js/background.js`

**Features:**
- Radial gold glow around mouse cursor
- Particles brighten when near cursor
- "Flame" center at cursor
- Ambient light extends ~300px
- Brightness reduced to 25% per user feedback

---

### 7. Custom Calendar Component (b70fbba, 3dab72b, 3169656)
**Added:** `public/js/calendar.js`
**Modified:** `public/index.html`, `public/css/style.css`, `public/js/app.js`

**Features:**
- Full month view with navigation
- Week view toggle with prev/next
- Color-coded events (green/gold/red)
- Click on day to filter schedule
- Click on event to view details
- Today highlighting
- Responsive design

**Bug Fixes:**
- Fixed onclick handlers to use `window.calendar`
- Fixed week view navigation to use currentDate
- Added dynamic week navigation

---

### 8. Session/Auth Fixes (699eefa)
**Modified:** `public/js/api.js`, `src/index.js`

**Problem:** API returning HTML instead of JSON (401 errors)

**Fixes:**
- Added content-type check in API request handler
- Reordered middleware (session before static files)
- Added sameSite: 'lax' to cookies

---

### 9. Full Roster Setup (629381e)
**Modified:** `src/seed.js`

**Teams Created:**
- U6-U8 Boys: 8 players (2 families)
- U6-U8 Girls: 8 players (2 families)
- U9-U10 Boys: 12 players (3 families)
- U9-U10 Girls: 12 players (3 families)
- U11-U12 Boys: 14 players (4 families)
- U11-U12 Girls: 14 players (4 families)
- U13-U16 Boys: 18 players (5 families)
- U13-U16 Girls: 18 players (5 families)

**Total:** 108 players, 28 families, 4 coaches

---

### 10. Case-Insensitive Email Login (dfdbe77)
**Modified:** `src/routes/auth.js`, `src/seed.js`

**Changes:**
- Registration stores email in lowercase
- Login converts input to lowercase before check
- Seed normalizes existing emails

---

## Testing Credentials

| Role   | Email              | Password    |
|--------|-------------------|-------------|
| Admin  | admin@vsc.com     | password123 |
| Coach  | coach1@vsc.com   | password123 |
| Coach  | coach2@vsc.com   | password123 |
| Coach  | coach3@vsc.com   | password123 |
| Coach  | coach4@vsc.com   | password123 |
| Family | family.anderson@vsc.com | password123 |

---

## Notes

- sql.js is WebAssembly-based - works without native compilation
- Database file: `data/vsc.db`
- Server runs on port 3000
- Use `npm run dev` to start
- Use `npm run stop` to stop
- Use `npm run seed` to reset database

---

## GitHub Issues

**Current Open Issues:**
- #2: "Schedule page - print schedule not clean"
- #3: "Game creation time - end time should always be set to default game time duration"

**Issue #1 Incident:**
- Originally closed wrong issue (#2)
- Later reopened #2 and closed #1
- Lesson: Always verify issue numbers before closing
